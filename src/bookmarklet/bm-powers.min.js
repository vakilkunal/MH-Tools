!function(){var e={"Indigenous Mice":"common","Dock Dwellers":"dock","Mountain Mice":"mountain","Forest Guild":"forest","Lab Experiments":"lab","Shadow Clan":"shadow","Digby Dirt Dwellers":"dirt","Followers of Furoma":"furoma","The Forgotten Mice":"forgotten","Aquatic Order":"hydro","The Elub Tribe":"elub","The Nerg Tribe":"nerg","The Derr Tribe":"derr","The Dreaded Horde":"dread","Draconic Brood":"dracaonic","Balack's Banished":"balack","Gauntlet Gladiators":"gauntlet","Seasonal Soldiers":"seasonal","Wizard's Pieces":"chess","Zurreal's Breed":"zzlibrary","Icewing's Invasion":"iceberg","Wild Bunch":"wild_bunch","Train Robbers":"train_robbers","Meteorite Miners":"fort_rox","The Marching Flame":"desertarmy","Muridae Market Mice":"desertmarket","Living Garden Mice":"living_garden","Lost City Mice":"lost_city","Sand Dunes Mice":"sand_dunes","Queso Canyoneers":"queso_canyon","Deep Sea Dwellers":"deep_sea_dwellers","Fungal Fiends":"fungal_cavern","Citizens of Zokor":"ancient_city","Moussu Picchu Inhabitants":"moussu_picchu","Rift Walkers":"rift_walkers","Rift Stalkers":"rift_stalkers","The Polluted":"polluted","Event Mice":"event"},t={"Indigenous Mice":["Misc.","Great Gnawnian Games","Rare Rodents"],"Dock Dwellers":["Misc."],"Mountain Mice":["Misc."],"Forest Guild":["Misc."],"Lab Experiments":["Misc."],"Shadow Clan":["Misc."],"Digby Dirt Dwellers":["Misc."],"Followers of Furoma":["Misc."],"The Forgotten Mice":["Misc."],"Aquatic Order":["Misc."],"The Elub Tribe":["Misc."],"The Nerg Tribe":["Misc."],"The Derr Tribe":["Misc."],"The Dreaded Horde":["Misc."],"Draconic Brood":["Misc."],"Balack's Banished":["Misc."],"Gauntlet Gladiators":["Tier 1: Puppet","Tier 2: Thief","Tier 3: Melee","Tier 4: Bard","Tier 5: Magic","Tier 6: Noble","Tier 7: Dust","Tier 8: The Eclipse"],"Seasonal Soldiers":["Spring","Summer","Fall","Winter"],"Wizard's Pieces":["Misc.","Mystic","Technic"],"Zurreal's Breed":["Misc."],"Icewing's Invasion":["Misc.","Bergling","Tunnel Rat","Brute","Bomb Squad","Zealot","Icewing's Generals"],"Wild Bunch":["Misc.","Crew","Ringleader"],"Train Robbers":["Passenger","Depot Worker","Automice","Raider","Fueler"],"Meteorite Miners":["Misc.","Weremice","Cosmic Critter","Special","Dawn Destroyer"],"The Marching Flame":["Archer","Artillery","Cavalry","Mage","Scout","Warrior","Support","Command"],"Muridae Market Mice":["Misc."],"Living Garden Mice":["Misc."],"Lost City Mice":["Misc."],"Sand Dunes Mice":["Misc."],"Queso Canyoneers":["River Riders","Spice Mice","Quarry Quarries","Cork Collector","Pressure Builder","Geyser Hunter"],"Deep Sea Dwellers":["Sunken City Citizen","Finned Fiend","Coral Corral","Barnacled Bunch","Scale Society","Treasure Troop","Predator Pack"],"Fungal Fiends":["Fungal Fodder","Gruyere Grazer","Mineral Muncher","Gemstone Gorger","Diamond Devourer"],"Citizens of Zokor":["Hallway Wanderer","Fungal Farmer","Lost Scholar","Fealty Sworn Soldier","Tech Engineer","Treasure Miser","Hidden Remnant"],"Moussu Picchu Inhabitants":["Fungal Feeder","Potion Brewer","Wind Wanderer","Rain Roamer","Storm Dragon"],"Rift Walkers":["Gnawnia Rift","Burroughs Rift","Whisker Woods Rift"],"Rift Stalkers":["Bristle Woods Rift","Furoma Rift","Valour Rift"],"The Polluted":["Misc."],"Event Mice":["Great Winter Hunt","Halloween","Spring Egg Hunt","New Year","Misc.","Prize","Birthday","Lunar New Year","Valentine's"]},r=["Arcane","Draconic","Forgotten","Hydro","Parental","Physical","Shadow","Tactical","Law","Rift"];function a(e){return null!=e&&"function"==typeof e[Symbol.iterator]}!function n(){if(!window.jQuery)return void alert("Error: jQuery is not enabled on this page");if(!$(".campPage-trap-trapStat.power > div:nth-child(2)").length)return void alert("Error: Can't find total trap power value\n\nPlease make sure you are on the Camp page of mousehuntgame.com and have FreshCoat enabled");var i=document.getElementById("mht-mouse-powers-tool");i&&i.remove();var o=document.createElement("div");o.id="mht-mouse-powers-tool";var s=document.createElement("button");s.textContent="x";s.onclick=function(){document.body.removeChild(o)};var l=document.createElement("span");l.style.fontSize="15px";l.style.fontWeight="bold";l.appendChild(document.createTextNode("Mouse Powers Bookmarklet"));var u=document.createElement("span");u.innerHTML="Pick a mouse group and hit Go";var c=document.createElement("span");c.innerHTML="This group requires a fetch";var d=document.createElement("select");d.setAttribute("id","mouse-subgroup-select");var p=document.createElement("select");p.setAttribute("id","mouse-group-select");p.onchange=function(){var e=$("#mouse-group-select :selected").text(),r=t[e],a=document.getElementById("mouse-subgroup-select");if(a){a.innerHTML="";for(var n=0;n<r.length;n++){var i=r[n];a.appendChild(new Option(i,i))}var o=localStorage.getItem("tsitu-powers-subgroups");if(o){var s=JSON.parse(o);if(s[e]){var l=new Date(s[e].timestamp).toLocaleString();c.innerText="This group was last updated on:\n"+l}else c.innerHTML="This group requires a fetch"}}};for(var m=0;m<Object.keys(e).length;m++){var h=Object.keys(e)[m];p.appendChild(new Option(h,h))}var g=document.createElement("span");g.innerHTML="Rift Bonus<br>None / Walker / Stalker";var f=document.createElement("input");f.setAttribute("type","radio");f.setAttribute("name","rift-bonus");f.setAttribute("value",0);var v=document.createElement("input");v.setAttribute("type","radio");v.setAttribute("name","rift-bonus");v.setAttribute("value",1);var b=document.createElement("input");b.setAttribute("type","radio");b.setAttribute("name","rift-bonus");b.setAttribute("value",2);b.setAttribute("checked","checked");var y=document.createElement("button");y.textContent="Update Subgroup Data";y.onclick=function(){var t=$("#mouse-group-select :selected").text(),r=$("#mouse-subgroup-select :selected").text(),a=[t,r];localStorage.setItem("tsitu-powers-selected",JSON.stringify(a));var i={sn:"Hitgrab",hg_is_ajax:"1",action:"get_group",category:e[t],user_id:user.user_id,display_mode:"images",view:"ViewMouseListGroups",uh:user.unique_hash};$.post("https://www.mousehuntgame.com/managers/ajax/mice/mouse_list.php",i,null,"json").done(function(e){if(e){var t=JSON.parse(localStorage.getItem("tsitu-powers-subgroups"))||{},r=e.mouse_list_category.name;t[r]={};for(var a=e.mouse_list_category.subgroups,i=0;i<a.length;i++){for(var o=a[i],s=[],l={},u=0;u<o.mice.length;u++){var c=o.mice[u];s.push(c.type),l[c.name]=c.type}t[r][o.name]={type:o.type,miceArr:s,miceObj:l}}t[r].timestamp=Date.now(),localStorage.setItem("tsitu-powers-subgroups",JSON.stringify(t)),n()}})};var w=document.createElement("button");w.textContent="Go";w.onclick=function(){var e=$("#mouse-group-select :selected").text(),t=$("#mouse-subgroup-select :selected").text(),n=[e,t];localStorage.setItem("tsitu-powers-selected",JSON.stringify(n)),function(e,t,n){var i=JSON.parse(localStorage.getItem("tsitu-powers-subgroups"))||{};try{for(var o=i[e][t],s=`https://www.mousehuntgame.com/managers/ajax/mice/getstat.php?sn=Hitgrab&hg_is_ajax=1&action=get_mice&uh=${user.unique_hash}`,l=0;l<o.miceArr.length;l++)s+="&mouse_types[]="+o.miceArr[l];$.post(s,{},null,"json").done(function(i){if(i){for(var o="",s=$(".campPage-trap-trapStat.power > div:nth-child(2)").map(function(){return $(this).context.textContent}).toArray()[0],l=parseInt(s.replace(/,/g,"")),u=0;u<r.length;u++)s.indexOf(r[u])>-1&&(o=r[u]);var c={"user-data":{}};c["user-data"].weapon=user.weapon_name,c["user-data"].base=user.base_name,c["user-data"].charm=user.trinket_name?user.trinket_name:"Baitkeep Charm",c["user-data"]["power-bonus"]=user.trap_power_bonus,c["user-data"].battery=0,c["user-data"]["zt-amp"]=100,c["user-data"]["tg-pour"]=!1,c["user-data"]["rift-multiplier"]=n,c["user-data"].empowered=!1,user.bait_name&&user.bait_name.indexOf("Empowered")>-1&&(c["user-data"].empowered=!0);var d=user.environment_name,p=user.quests;if("Furoma Rift"===d){var m=p.QuestRiftFuroma.droid.charge_level;if(""!==m){c["user-data"].battery={charge_level_one:1,charge_level_two:2,charge_level_three:3,charge_level_four:4,charge_level_five:5,charge_level_six:6,charge_level_seven:7,charge_level_eight:8,charge_level_nine:9,charge_level_ten:10}[m]}}else"Zugzwang's Tower"===d?c["user-data"]["zt-amp"]=user.viewing_atts.zzt_amplifier:"Twisted Garden"===d&&"dumped"===p.QuestLivingGarden.minigame.vials_state&&(c["user-data"]["tg-pour"]=!0);var h=Date.now();c["user-data"].timestamp=h,c["user-data"]["dom-trap-type"]=o,c["user-data"]["dom-trap-power"]=l,console.group("Displayed Power: "+l+" ("+o+") ["+new Date(h)+"]");var g=e+" ("+t+")";c["mouse-data"]={},c["mouse-data"][g]={},console.group("Group: "+g);for(var f=0;f<i.mice.length;f++){var v=i.mice[f],b=v.abbreviated_name.trim();console.log(b+" ("+v.difficulty+")");var y={};y.id="number"==typeof v.id?v.id:parseInt(v.id.replace(/,/g,"")),y.gold="number"==typeof v.gold?v.gold:parseInt(v.gold.replace(/,/g,"")),y.points="number"==typeof v.points?v.points:parseInt(v.points.replace(/,/g,"")),y.difficulty=v.difficulty;var w={Arcane:0,Draconic:0,Forgotten:0,Hydro:0,Parental:0,Physical:0,Shadow:0,Tactical:0,Law:0,Rift:0},M=r,_=v.weaknesses;if(Object.keys(_).length>0){if(a(_.effective))for(var C=0;C<_.effective.length;C++){var T=_.effective[C];w[T.name]=100,M=M.filter(function(e){return e!==T.name})}if(a(_.veryEffective))for(var C=0;C<_.veryEffective.length;C++){var T=_.veryEffective[C];w[T.name]=">100",M=M.filter(function(e){return e!==T.name})}if(a(_.lessEffective))for(var C=0;C<_.lessEffective.length;C++){var T=_.lessEffective[C];w[T.name]="<100",M=M.filter(function(e){return e!==T.name})}if(a(M))for(var C=0;C<M.length;C++)w[M[C]]=0}y.effs=[],y.effs.push(w.Arcane),y.effs.push(w.Draconic),y.effs.push(w.Forgotten),y.effs.push(w.Hydro),y.effs.push(w.Parental),y.effs.push(w.Physical),y.effs.push(w.Shadow),y.effs.push(w.Tactical),y.effs.push(w.Law),y.effs.push(w.Rift),c["mouse-data"][g][b]=y}console.groupEnd(),console.groupEnd();var S=window.open("");S.name=JSON.stringify(c),S.location="https://tsitu.github.io/MH-Tools/powers-worksheet.html"}})}catch(t){alert("Please click 'Update Subgroup Data' to perform initial fetch for:\n\n"+e)}}(e,t,parseInt($("input[name=rift-bonus]:checked").val()))};o.appendChild(s);o.appendChild(document.createElement("br"));o.appendChild(document.createElement("br"));o.appendChild(l);o.appendChild(document.createElement("br"));o.appendChild(u);o.appendChild(document.createElement("br"));o.appendChild(document.createElement("br"));o.appendChild(p);o.appendChild(document.createElement("br"));o.appendChild(d);o.appendChild(document.createElement("br"));o.appendChild(document.createElement("br"));o.appendChild(c);o.appendChild(document.createElement("br"));o.appendChild(y);o.appendChild(document.createElement("br"));o.appendChild(document.createElement("br"));o.appendChild(g);o.appendChild(document.createElement("br"));o.appendChild(f);o.appendChild(v);o.appendChild(b);o.appendChild(document.createElement("br"));o.appendChild(document.createElement("br"));o.appendChild(w);o.style.backgroundColor="#F5F5F5";o.style.position="fixed";o.style.zIndex="9999";o.style.left="20%";o.style.top="88px";o.style.border="solid 3px #696969";o.style.borderRadius="20px";o.style.padding="10px";o.style.textAlign="center";document.body.appendChild(o);var M=JSON.parse(localStorage.getItem("tsitu-powers-selected"))||[];2===M.length?(p.value=M[0],p.onchange(),d.value=M[1]):(p.value="Indigenous Mice",p.onchange())}()}();